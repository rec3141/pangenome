

Testing the Infinitely Many Genes Model of the Bacterial Pangenome
R. Eric Collins and Paul G. Higgs

ABSTRACT
When groups of related bacterial genomes are compared, the number of core genes found in all genomes is usually much less than the mean genome size, while the size of the pangenome (the set of genes found on at least one of the genomes) is much larger than the mean size of one genome. We analyze 172 complete genomes of Bacilli and compare the properties of the pangenomes and core genomes of monophyletic subsets taken from this group. We then assess the capabilities of several evolutionary models to predict these properties. The infinitely many genes (IMG) model is based on the assumption that each new gene can arise only once. The predictions of the model depend on the shape of the evolutionary tree that underlies the divergence of the genomes. We calculate results for coalescent trees, star trees, and arbitrary phylogenetic trees of predefined fixed branch length. On a star tree, the pangenome size increases linearly with the number of genomes, as has been suggested in some previous studies, whereas on a coalescent tree, it increases logarithmically. The coalescent tree gives a better fit to the data, for all the examples we consider. In some cases, a fixed phylogenetic tree proved better than the coalescent tree at reproducing structure in the gene frequency spectrum, but little improvement was gained in predictions of the core and pangenome sizes. Most of the data are well explained by a model with three classes of gene: an essential class that is found in all genomes, a slow class, whose rate of origination and deletion is slow compared to the time of divergence of the genomes, and a fast class showing rapid origination and deletion. Although the majority of genes originating in a genome are in the fast class, these genes are not retained for long periods, and the majority of genes present in a genome are in the slow or essential classes. In general, we show that the IMG model is useful for comparison with experimental genome data both for species-level and widely-divergent taxonomic groups. Software implementing the described formulae is provided at http://github.com/rec3141/pangenome.

SOFTWARE
Many of the formulae described in our paper are available as functions written in the R statistical programming language, downloadable at http://github.com/rec3141/pangenome.

A helper script provides example usage and plotting for each of the functions using an example dataset. Users can compute the gene family frequency spectrum from a matrix of gene clusters or using various models on a coalescent or fixed tree. The mean core genome and pangenome curves can be calculated from the gene family frequency spectrum or using the models on either a coalescent tree, a star tree, or a fixed tree provided by the user. Permutations of these curves may be computed from gene cluster data. Fitting functions are also defined to allow users to fit each model to their own data.

-- The main script is pangenome-examples.R, there are more details in the header of that file on how to run it
-- The functions are in f-pangenome.R, which is called by pangenome-examples.R

